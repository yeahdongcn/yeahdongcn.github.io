(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{4192:function(e,t){t.argVal=function(e){this._cursor.args.push(e)},t.arrayStart=function(){this._placeAtCursor({type:"ArrayLiteral",value:[]})},t.arrayVal=function(e){e&&this._cursor.value.push(e)},t.binaryOp=function(e){const t=this._grammar[e.value].precedence||0;let r=this._cursor._parent;for(;r&&r.operator&&this._grammar[r.operator].precedence>=t;)this._cursor=r,r=r._parent;const n={type:"BinaryExpression",operator:e.value,left:this._cursor};this._setParent(this._cursor,n),this._cursor=r,this._placeAtCursor(n)},t.dot=function(){this._nextIdentEncapsulate=this._cursor&&"UnaryExpression"!==this._cursor.type&&("BinaryExpression"!==this._cursor.type||"BinaryExpression"===this._cursor.type&&this._cursor.right),this._nextIdentRelative=!this._cursor||this._cursor&&!this._nextIdentEncapsulate,this._nextIdentRelative&&(this._relative=!0)},t.filter=function(e){this._placeBeforeCursor({type:"FilterExpression",expr:e,relative:this._subParser.isRelative(),subject:this._cursor})},t.identifier=function(e){const t={type:"Identifier",value:e.value};this._nextIdentEncapsulate?(t.from=this._cursor,this._placeBeforeCursor(t),this._nextIdentEncapsulate=!1):(this._nextIdentRelative&&(t.relative=!0,this._nextIdentRelative=!1),this._placeAtCursor(t))},t.literal=function(e){this._placeAtCursor({type:"Literal",value:e.value})},t.objKey=function(e){this._curObjKey=e.value},t.objStart=function(){this._placeAtCursor({type:"ObjectLiteral",value:{}})},t.objVal=function(e){this._cursor.value[this._curObjKey]=e},t.subExpression=function(e){this._placeAtCursor(e)},t.ternaryEnd=function(e){this._cursor.alternate=e},t.ternaryMid=function(e){this._cursor.consequent=e},t.ternaryStart=function(){this._tree={type:"ConditionalExpression",test:this._tree},this._cursor=this._tree},t.transform=function(e){this._placeBeforeCursor({type:"Transform",name:e.value,args:[],subject:this._cursor})},t.unaryOp=function(e){this._placeAtCursor({type:"UnaryExpression",operator:e.value})}},4313:function(e,t,r){const n=r(4314),o=r(4321).elements;class l{constructor(){this.expr=this.expr.bind(this),this._grammar=Object.assign({},o),this._lexer=null,this._transforms={}}addBinaryOp(e,t,r){this._addGrammarElement(e,{type:"binaryOp",precedence:t,eval:r})}addUnaryOp(e,t){this._addGrammarElement(e,{type:"unaryOp",weight:1/0,eval:t})}addTransform(e,t){this._transforms[e]=t}addTransforms(map){for(let e in map)map.hasOwnProperty(e)&&(this._transforms[e]=map[e])}compile(e){return this.createExpression(e).compile()}createExpression(e){const t=this._getLang();return new n(t,e)}getTransform(e){return this._transforms[e]}eval(e,t={}){return this.createExpression(e).eval(t)}evalSync(e,t={}){return this.createExpression(e).evalSync(t)}expr(e,...t){const r=e.reduce((e,r,n)=>e+=r+(n<t.length?t[n]:""),"");return this.createExpression(r)}removeOp(e){!this._grammar[e]||"binaryOp"!==this._grammar[e].type&&"unaryOp"!==this._grammar[e].type||delete this._grammar[e]}_addGrammarElement(e,t){this._grammar[e]=t}_getLang(){return{grammar:this._grammar,transforms:this._transforms}}}e.exports=new l,e.exports.Jexl=l},4314:function(e,t,r){const n=r(4315),o=r(4317),l=r(4318),c=r(4320);e.exports=class{constructor(e,t){this._lang=e,this._lexer=new o(e.grammar),this._exprStr=t,this._ast=null}compile(){const e=new o(this._lang.grammar),t=new l(this._lang.grammar),r=e.tokenize(this._exprStr);return t.addTokens(r),this._ast=t.complete(),this}eval(e={}){return this._eval(e,Promise)}evalSync(e={}){const t=this._eval(e,c);if(t.error)throw t.error;return t.value}_eval(e,t){return t.resolve().then(()=>{const r=this._getAst();return new n(this._lang.grammar,this._lang.transforms,e,void 0,t).eval(r)})}_getAst(){return this._ast||this.compile(),this._ast}}},4315:function(e,t,r){const n=r(4316);class o{constructor(e,t,r,n,o=Promise){this._grammar=e,this._transforms=t||{},this._context=r||{},this._relContext=n||this._context,this.Promise=o}eval(e){return this.Promise.resolve().then(()=>n[e.type].call(this,e))}evalArray(e){return this.Promise.all(e.map(e=>this.eval(e)))}evalMap(map){const e=Object.keys(map),t={},r=e.map(e=>this.eval(map[e]));return this.Promise.all(r).then(r=>(r.forEach((r,n)=>{t[e[n]]=r}),t))}_filterRelative(e,t){const r=[];return Array.isArray(e)||(e=void 0===e?[]:[e]),e.forEach(e=>{const n=new o(this._grammar,this._transforms,this._context,e,this.Promise);r.push(n.eval(t))}),this.Promise.all(r).then(t=>{const r=[];return t.forEach((t,n)=>{t&&r.push(e[n])}),r})}_filterStatic(e,t){return this.eval(t).then(t=>"boolean"==typeof t?t?e:void 0:e[t])}}e.exports=o},4316:function(e,t){t.ArrayLiteral=function(e){return this.evalArray(e.value)},t.BinaryExpression=function(e){return this.Promise.all([this.eval(e.left),this.eval(e.right)]).then(t=>this._grammar[e.operator].eval(t[0],t[1]))},t.ConditionalExpression=function(e){return this.eval(e.test).then(t=>t?e.consequent?this.eval(e.consequent):t:this.eval(e.alternate))},t.FilterExpression=function(e){return this.eval(e.subject).then(t=>e.relative?this._filterRelative(t,e.expr):this._filterStatic(t,e.expr))},t.Identifier=function(e){return e.from?this.eval(e.from).then(t=>{if(null!=t)return Array.isArray(t)&&(t=t[0]),t[e.value]}):e.relative?this._relContext[e.value]:this._context[e.value]},t.Literal=function(e){return e.value},t.ObjectLiteral=function(e){return this.evalMap(e.value)},t.Transform=function(e){const t=this._transforms[e.name];if(!t)throw new Error(`Transform ${e.name} is not defined.`);return this.Promise.all([this.eval(e.subject),this.evalArray(e.args||[])]).then(e=>t.apply(null,[e[0]].concat(e[1])))},t.UnaryExpression=function(e){return this.eval(e.right).then(t=>this._grammar[e.operator].eval(t))}},4317:function(e,t){const r=/^-?(?:(?:[0-9]*\.[0-9]+)|[0-9]+)$/,n=/^[a-zA-Z_$][a-zA-Z0-9_$]*$/,o=/\\\\/,l=/^\s*$/,c=["'(?:(?:\\\\')|[^'])*'",'"(?:(?:\\\\")|[^"])*"',"\\s+","\\btrue\\b","\\bfalse\\b"],h=["[a-zA-Z_\\$][a-zA-Z0-9_\\$]*","(?:(?:[0-9]*\\.[0-9]+)|[0-9]+)"],_=["binaryOp","unaryOp","openParen","openBracket","question","colon"];e.exports=class{constructor(e){this._grammar=e}getElements(e){const t=this._getSplitRegex();return e.split(t).filter(e=>e)}getTokens(e){const t=[];let r=!1;for(let i=0;i<e.length;i++)this._isWhitespace(e[i])?t.length&&(t[t.length-1].raw+=e[i]):"-"===e[i]&&this._isNegative(t)?r=!0:(r&&(e[i]="-"+e[i],r=!1),t.push(this._createToken(e[i])));return r&&t.push(this._createToken("-")),t}tokenize(e){const t=this.getElements(e);return this.getTokens(t)}_createToken(element){const e={type:"literal",value:element,raw:element};if('"'===element[0]||"'"===element[0])e.value=this._unquote(element);else if(element.match(r))e.value=parseFloat(element);else if("true"===element||"false"===element)e.value="true"===element;else if(this._grammar[element])e.type=this._grammar[element].type;else{if(!element.match(n))throw new Error("Invalid expression token: "+element);e.type="identifier"}return e}_escapeRegExp(e){return(e=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).match(n)&&(e="\\b"+e+"\\b"),e}_getSplitRegex(){if(!this._splitRegex){const e=Object.keys(this._grammar).sort((a,b)=>b.length-a.length).map(e=>this._escapeRegExp(e),this);this._splitRegex=new RegExp("("+[c.join("|"),e.join("|"),h.join("|")].join("|")+")")}return this._splitRegex}_isNegative(e){return!e.length||_.some(t=>t===e[e.length-1].type)}_isWhitespace(e){return!!e.match(l)}_unquote(e){const t=e[0],r=new RegExp("\\\\"+t,"g");return e.substr(1,e.length-2).replace(r,t).replace(o,"\\")}}},4318:function(e,t,r){const n=r(4192),o=r(4319).states;class l{constructor(e,t,r){this._grammar=e,this._state="expectOperand",this._tree=null,this._exprStr=t||"",this._relative=!1,this._stopMap=r||{}}addToken(e){if("complete"===this._state)throw new Error("Cannot add a new token to a completed Parser");const t=o[this._state],r=this._exprStr;if(this._exprStr+=e.raw,t.subHandler){this._subParser||this._startSubExpression(r);const t=this._subParser.addToken(e);if(t){if(this._endSubExpression(),this._parentStop)return t;this._state=t}}else{if(!t.tokenTypes[e.type]){if(this._stopMap[e.type])return this._stopMap[e.type];throw new Error(`Token ${e.raw} (${e.type}) unexpected in expression: ${this._exprStr}`)}{const r=t.tokenTypes[e.type];let o=n[e.type];r.handler&&(o=r.handler),o&&o.call(this,e),r.toState&&(this._state=r.toState)}}return!1}addTokens(e){e.forEach(this.addToken,this)}complete(){if(this._cursor&&!o[this._state].completable)throw new Error("Unexpected end of expression: "+this._exprStr);return this._subParser&&this._endSubExpression(),this._state="complete",this._cursor?this._tree:null}isRelative(){return this._relative}_endSubExpression(){o[this._state].subHandler.call(this,this._subParser.complete()),this._subParser=null}_placeAtCursor(e){this._cursor?(this._cursor.right=e,this._setParent(e,this._cursor)):this._tree=e,this._cursor=e}_placeBeforeCursor(e){this._cursor=this._cursor._parent,this._placeAtCursor(e)}_setParent(e,t){Object.defineProperty(e,"_parent",{value:t,writable:!0})}_startSubExpression(e){let t=o[this._state].endStates;t||(this._parentStop=!0,t=this._stopMap),this._subParser=new l(this._grammar,e,t)}}e.exports=l},4319:function(e,t,r){const n=r(4192);t.states={expectOperand:{tokenTypes:{literal:{toState:"expectBinOp"},identifier:{toState:"identifier"},unaryOp:{},openParen:{toState:"subExpression"},openCurl:{toState:"expectObjKey",handler:n.objStart},dot:{toState:"traverse"},openBracket:{toState:"arrayVal",handler:n.arrayStart}}},expectBinOp:{tokenTypes:{binaryOp:{toState:"expectOperand"},pipe:{toState:"expectTransform"},dot:{toState:"traverse"},question:{toState:"ternaryMid",handler:n.ternaryStart}},completable:!0},expectTransform:{tokenTypes:{identifier:{toState:"postTransform",handler:n.transform}}},expectObjKey:{tokenTypes:{identifier:{toState:"expectKeyValSep",handler:n.objKey},closeCurl:{toState:"expectBinOp"}}},expectKeyValSep:{tokenTypes:{colon:{toState:"objVal"}}},postTransform:{tokenTypes:{openParen:{toState:"argVal"},binaryOp:{toState:"expectOperand"},dot:{toState:"traverse"},openBracket:{toState:"filter"},pipe:{toState:"expectTransform"}},completable:!0},postTransformArgs:{tokenTypes:{binaryOp:{toState:"expectOperand"},dot:{toState:"traverse"},openBracket:{toState:"filter"},pipe:{toState:"expectTransform"}},completable:!0},identifier:{tokenTypes:{binaryOp:{toState:"expectOperand"},dot:{toState:"traverse"},openBracket:{toState:"filter"},pipe:{toState:"expectTransform"},question:{toState:"ternaryMid",handler:n.ternaryStart}},completable:!0},traverse:{tokenTypes:{identifier:{toState:"identifier"}}},filter:{subHandler:n.filter,endStates:{closeBracket:"identifier"}},subExpression:{subHandler:n.subExpression,endStates:{closeParen:"expectBinOp"}},argVal:{subHandler:n.argVal,endStates:{comma:"argVal",closeParen:"postTransformArgs"}},objVal:{subHandler:n.objVal,endStates:{comma:"expectObjKey",closeCurl:"expectBinOp"}},arrayVal:{subHandler:n.arrayVal,endStates:{comma:"arrayVal",closeBracket:"expectBinOp"}},ternaryMid:{subHandler:n.ternaryMid,endStates:{colon:"ternaryEnd"}},ternaryEnd:{subHandler:n.ternaryEnd,completable:!0}}},4320:function(e,t){class r{constructor(e){e(this._resolve.bind(this),this._reject.bind(this))}catch(e){if(this.error)try{this._resolve(e(this.error))}catch(e){this._reject(e)}return this}then(e,t){if(!this.error)try{this._resolve(e(this.value))}catch(e){this._reject(e)}return t&&this.catch(t),this}_reject(e){this.value=void 0,this.error=e}_resolve(e){e instanceof r?e.error?this._reject(e.error):this._resolve(e.value):(this.value=e,this.error=void 0)}}r.all=e=>new r(t=>{t(e.map(e=>{for(;e instanceof r;){if(e.error)throw Error(e.error);e=e.value}return e}))}),r.resolve=e=>new r(t=>t(e)),r.reject=e=>new r((t,r)=>r(e)),e.exports=r},4321:function(e,t){t.elements={".":{type:"dot"},"[":{type:"openBracket"},"]":{type:"closeBracket"},"|":{type:"pipe"},"{":{type:"openCurl"},"}":{type:"closeCurl"},":":{type:"colon"},",":{type:"comma"},"(":{type:"openParen"},")":{type:"closeParen"},"?":{type:"question"},"+":{type:"binaryOp",precedence:30,eval:(e,t)=>e+t},"-":{type:"binaryOp",precedence:30,eval:(e,t)=>e-t},"*":{type:"binaryOp",precedence:40,eval:(e,t)=>e*t},"/":{type:"binaryOp",precedence:40,eval:(e,t)=>e/t},"//":{type:"binaryOp",precedence:40,eval:(e,t)=>Math.floor(e/t)},"%":{type:"binaryOp",precedence:50,eval:(e,t)=>e%t},"^":{type:"binaryOp",precedence:50,eval:(e,t)=>Math.pow(e,t)},"==":{type:"binaryOp",precedence:20,eval:(e,t)=>e==t},"!=":{type:"binaryOp",precedence:20,eval:(e,t)=>e!=t},">":{type:"binaryOp",precedence:20,eval:(e,t)=>e>t},">=":{type:"binaryOp",precedence:20,eval:(e,t)=>e>=t},"<":{type:"binaryOp",precedence:20,eval:(e,t)=>e<t},"<=":{type:"binaryOp",precedence:20,eval:(e,t)=>e<=t},"&&":{type:"binaryOp",precedence:10,eval:(e,t)=>e&&t},"||":{type:"binaryOp",precedence:10,eval:(e,t)=>e||t},in:{type:"binaryOp",precedence:20,eval:(e,t)=>"string"==typeof t?-1!==t.indexOf(e):!!Array.isArray(t)&&t.some(t=>t===e)},"!":{type:"unaryOp",precedence:1/0,eval:e=>!e}}}}]);
//# sourceMappingURL=install.c3535f5d01c9ca672d4a.js.map